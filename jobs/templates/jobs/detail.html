{% extends 'base.html' %}

{% block title %}{{ job.title }} - MyApply{% endblock %}

{% block content %}
<div class="job-detail">
    <div class="card-header">
        <h1 class="card-title">
            Job Details
        </h1>
        <div>
            <a href="{% url 'job_edit' job.id %}" class="btn">Edit</a>
            <a href="{% url 'job_delete' job.id %}" class="btn btn-danger">Delete</a>
        </div>
    </div>

    <div class="card mt-2">
        <div class="card-header">
            <h2 class="card-title">{{ job.title }}</h2>
            <span class="text-muted">{{ job.company }}</span>
        </div>
        <div class="card-body">
            <div class="grid grid-2 mb-2">
                <div>
                    <p class="text-muted">Location</p>
                    <p>{{ job.location_text|default:"N/A" }}</p>
                </div>
                <div>
                    <p class="text-muted">Created</p>
                    <p>{{ job.created_at|date:"M d, Y H:i" }}</p>
                </div>
            </div>

            {% if job.source_url %}
            <div class="mb-2">
                <p class="text-muted">URL</p>
                <p><a href="{{ job.source_url }}" target="_blank" class="text-success">{{ job.source_url }}</a></p>
            </div>
            {% endif %}

            <div class="mb-2">
                <p class="text-muted">Description</p>
                <div class="code-block">
                    <pre>{{ job.raw_description }}</pre>
                </div>
            </div>

            {% if job.parsed_requirements %}
            <div class="mb-2">
                <p class="text-muted">Parsed Requirements</p>
                <div class="code-block">
                    <pre>{{ job.parsed_requirements|pprint }}</pre>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="card mt-2">
        <div class="card-header">
            <h2 class="card-title">Quick Actions</h2>
        </div>
        <div class="card-body">
            <form method="post" action="{% url 'tailoring_create' %}">
                {% csrf_token %}
                <input type="hidden" name="job_id" value="{{ job.id }}">
                <button type="submit" class="btn btn-primary">Create Tailoring Session</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}
